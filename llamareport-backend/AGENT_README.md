# ğŸ¤– LlamaReport Agent ç³»ç»Ÿ

> åŸºäº LlamaIndex FunctionAgent çš„æ™ºèƒ½å¹´æŠ¥åˆ†æç³»ç»Ÿ

## ğŸ“– ç®€ä»‹

LlamaReport Agent æ˜¯ä¸€ä¸ªæ™ºèƒ½å¹´æŠ¥åˆ†æç³»ç»Ÿ,èƒ½å¤Ÿè‡ªåŠ¨åˆ†æå¹´æŠ¥æ–‡æ¡£å¹¶ç”Ÿæˆç»“æ„åŒ–çš„åˆ†ææŠ¥å‘Šã€‚ç³»ç»Ÿä½¿ç”¨ LlamaIndex çš„ FunctionAgent æ¡†æ¶,ç»“åˆ DeepSeek LLM å’Œ OpenAI Embedding,å®ç°äº†é«˜è´¨é‡çš„å¹´æŠ¥åˆ†æå’ŒæŠ¥å‘Šç”Ÿæˆã€‚

### âœ¨ æ ¸å¿ƒç‰¹æ€§

- ğŸ¤– **æ™ºèƒ½ Agent**: ä½¿ç”¨ FunctionAgent è‡ªåŠ¨åè°ƒå¤šä¸ªå·¥å…·å®Œæˆå¤æ‚ä»»åŠ¡
- ğŸ“Š **ç»“æ„åŒ–è¾“å‡º**: åŸºäº Pydantic æ¨¡å‹ç¡®ä¿æ•°æ®è´¨é‡å’Œç±»å‹å®‰å…¨
- ğŸ“ **æ¨¡æ¿åŒ–æŠ¥å‘Š**: ä½¿ç”¨ Jinja2 æ¨¡æ¿ç”Ÿæˆæ ‡å‡†æ ¼å¼çš„ Markdown æŠ¥å‘Š
- ğŸ”§ **æ¨¡å—åŒ–è®¾è®¡**: å¯å•ç‹¬ç”Ÿæˆå„ä¸ªç« èŠ‚æˆ–å®Œæ•´æŠ¥å‘Š
- ğŸš€ **é«˜æ€§èƒ½**: å…¨å¼‚æ­¥æ¶æ„,æ”¯æŒå¹¶å‘å¤„ç†
- ğŸŒ **API å‹å¥½**: RESTful API,æ˜“äºé›†æˆåˆ°å‰ç«¯åº”ç”¨

### ğŸ“‹ æŠ¥å‘Šç»“æ„

ç”Ÿæˆçš„å¹´æŠ¥åˆ†æåŒ…å«ä»¥ä¸‹äº”ä¸ªéƒ¨åˆ†:

1. **è´¢åŠ¡ç‚¹è¯„** - è´¢åŠ¡å›¾è¡¨ã€ä¸šç»©é€Ÿè§ˆã€ä¸šç»©å¯¹æ¯”ã€æŒ‡æ ‡å½’å› 
2. **ä¸šç»©æŒ‡å¼•** - ä¸šç»©é¢„å‘Šã€ç»è¥è®¡åˆ’ã€é£é™©æç¤º
3. **ä¸šåŠ¡äº®ç‚¹** - å„ä¸šåŠ¡æ¿å—çš„äº®ç‚¹å’Œæˆå°±
4. **ç›ˆåˆ©é¢„æµ‹å’Œä¼°å€¼** - ä¸€è‡´é¢„æµ‹ã€æœºæ„é¢„æµ‹ã€ä¼°å€¼åˆ†æ
5. **æ€»ç»“** - ç»¼åˆæ‰€æœ‰éƒ¨åˆ†çš„æ€»ç»“

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
cd llamareport-backend
pip install -r requirements.txt
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `.env` æ–‡ä»¶:

```env
# OpenAI API (ç”¨äº Embedding)
OPENAI_API_KEY=your_openai_api_key

# DeepSeek API (ç”¨äºå¯¹è¯æ¨¡å‹)
DEEPSEEK_API_KEY=your_deepseek_api_key
DEEPSEEK_MODEL=deepseek-chat
DEEPSEEK_BASE_URL=https://api.deepseek.com
```

### 3. è¿è¡Œæµ‹è¯•

```bash
# æµ‹è¯•ç³»ç»Ÿç»„ä»¶
python test_agent_system.py

# å¿«é€Ÿå¯åŠ¨å‘å¯¼
python quick_start_agent.py
```

### 4. å¯åŠ¨æœåŠ¡å™¨

```bash
python main.py
```

æœåŠ¡å™¨å°†åœ¨ `http://localhost:8000` å¯åŠ¨ã€‚

### 5. ç”ŸæˆæŠ¥å‘Š

#### æ–¹æ³• 1: ä½¿ç”¨ API

```bash
curl -X POST "http://localhost:8000/agent/generate-report" \
  -H "Content-Type: application/json" \
  -d '{
    "company_name": "STæ•°æº",
    "year": "2023",
    "save_to_file": true
  }'
```

#### æ–¹æ³• 2: ä½¿ç”¨ Python

```python
import asyncio
from core.rag_engine import RAGEngine
from agents.report_agent import ReportAgent

async def generate_report():
    # åˆå§‹åŒ–
    rag = RAGEngine()
    rag.load_existing_index()
    agent = ReportAgent(rag.query_engine)
    
    # ç”ŸæˆæŠ¥å‘Š
    result = await agent.generate_report(
        company_name="STæ•°æº",
        year="2023"
    )
    
    print(result["report"])

asyncio.run(generate_report())
```

---

## ğŸ“š æ–‡æ¡£

- **[ä½¿ç”¨æŒ‡å—](AGENT_SYSTEM_GUIDE.md)** - è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜å’Œ API æ–‡æ¡£
- **[å®æ–½æ€»ç»“](AGENT_IMPLEMENTATION_SUMMARY.md)** - æŠ€æœ¯å®ç°ç»†èŠ‚å’Œæ¶æ„è¯´æ˜
- **[æ¨¡æ¿å‚è€ƒ](../å‚è€ƒæ–‡æ¡£/02/æ¨¡æ¿.md)** - æŠ¥å‘Šæ¨¡æ¿æ ¼å¼å‚è€ƒ

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·è¯·æ±‚                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   FastAPI (Agent API)                        â”‚
â”‚  /agent/generate-report  /agent/generate-section            â”‚
â”‚  /agent/query           /agent/status                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ReportAgent (FunctionAgent)                     â”‚
â”‚  - åè°ƒå·¥å…·è°ƒç”¨                                              â”‚
â”‚  - ç®¡ç†å·¥ä½œæµç¨‹                                              â”‚
â”‚  - ç”Ÿæˆç»“æ„åŒ–è¾“å‡º                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚               â”‚               â”‚
         â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚QueryEngine  â”‚  â”‚Financial    â”‚  â”‚Business     â”‚
â”‚Tool         â”‚  â”‚ReviewTool   â”‚  â”‚GuidanceTool â”‚
â”‚             â”‚  â”‚             â”‚  â”‚             â”‚
â”‚RAGæ£€ç´¢      â”‚  â”‚è´¢åŠ¡ç‚¹è¯„     â”‚  â”‚ä¸šç»©æŒ‡å¼•     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚               â”‚               â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Pydantic ç»“æ„åŒ–è¾“å‡º                         â”‚
â”‚  AnnualReportAnalysis                                        â”‚
â”‚  â”œâ”€ FinancialReview                                         â”‚
â”‚  â”œâ”€ BusinessGuidance                                        â”‚
â”‚  â”œâ”€ BusinessHighlights                                      â”‚
â”‚  â””â”€ ProfitForecastAndValuation                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            TemplateRenderer (Jinja2)                         â”‚
â”‚  annual_report_template.md.jinja2                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Markdown æŠ¥å‘Š                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
llamareport-backend/
â”œâ”€â”€ models/
â”‚   â””â”€â”€ report_models.py              # Pydantic æ•°æ®æ¨¡å‹
â”œâ”€â”€ agents/
â”‚   â”œâ”€â”€ report_tools.py               # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ report_agent.py               # Agent é…ç½®
â”‚   â””â”€â”€ template_renderer.py          # æ¨¡æ¿æ¸²æŸ“å™¨
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ annual_report_template.md.jinja2  # Jinja2 æ¨¡æ¿
â”œâ”€â”€ api/
â”‚   â””â”€â”€ agent.py                      # Agent API æ¥å£
â”œâ”€â”€ core/
â”‚   â””â”€â”€ rag_engine.py                 # RAG å¼•æ“
â”œâ”€â”€ test_agent_system.py              # æµ‹è¯•è„šæœ¬
â”œâ”€â”€ quick_start_agent.py              # å¿«é€Ÿå¯åŠ¨è„šæœ¬
â”œâ”€â”€ AGENT_SYSTEM_GUIDE.md             # ä½¿ç”¨æŒ‡å—
â”œâ”€â”€ AGENT_IMPLEMENTATION_SUMMARY.md   # å®æ–½æ€»ç»“
â””â”€â”€ AGENT_README.md                   # æœ¬æ–‡æ¡£
```

---

## ğŸ”§ æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯ | ç”¨é€” |
|------|------|------|
| Web æ¡†æ¶ | FastAPI | API æœåŠ¡å™¨ |
| LLM | DeepSeek | å¯¹è¯ç”Ÿæˆ |
| Embedding | OpenAI | æ–‡æœ¬åµŒå…¥ |
| Agent æ¡†æ¶ | LlamaIndex FunctionAgent | æ™ºèƒ½å†³ç­– |
| æ•°æ®éªŒè¯ | Pydantic | ç±»å‹å®‰å…¨ |
| æ¨¡æ¿å¼•æ“ | Jinja2 | æŠ¥å‘Šæ¸²æŸ“ |
| å‘é‡æ•°æ®åº“ | ChromaDB | æ–‡æ¡£å­˜å‚¨ |
| PDF å¤„ç† | pdfplumber | æ–‡æ¡£è§£æ |

---

## ğŸ“Š API ç«¯ç‚¹

### ç”Ÿæˆå®Œæ•´æŠ¥å‘Š

```http
POST /agent/generate-report
Content-Type: application/json

{
    "company_name": "å…¬å¸åç§°",
    "year": "2023",
    "save_to_file": true,
    "output_path": "reports/report.md"
}
```

### ç”Ÿæˆå•ä¸ªç« èŠ‚

```http
POST /agent/generate-section
Content-Type: application/json

{
    "section_name": "financial_review",
    "company_name": "å…¬å¸åç§°",
    "year": "2023"
}
```

ç« èŠ‚åç§°:
- `financial_review` - è´¢åŠ¡ç‚¹è¯„
- `business_guidance` - ä¸šç»©æŒ‡å¼•
- `business_highlights` - ä¸šåŠ¡äº®ç‚¹
- `profit_forecast` - ç›ˆåˆ©é¢„æµ‹å’Œä¼°å€¼

### é€šç”¨æŸ¥è¯¢

```http
POST /agent/query
Content-Type: application/json

{
    "question": "å…¬å¸çš„ä¸»è¦ä¸šåŠ¡æ˜¯ä»€ä¹ˆ?"
}
```

### ç³»ç»ŸçŠ¶æ€

```http
GET /agent/status
```

---

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
python test_agent_system.py
```

### æµ‹è¯•ç»“æœ

```
âœ… é€šè¿‡ - å¯¼å…¥æµ‹è¯•
âœ… é€šè¿‡ - æ¨¡æ¿æ¸²æŸ“å™¨æµ‹è¯•
âœ… é€šè¿‡ - RAG å¼•æ“æµ‹è¯•
âœ… é€šè¿‡ - Report Agent æµ‹è¯•

æ€»è®¡: 4 ä¸ªæµ‹è¯•é€šè¿‡, 0 ä¸ªæµ‹è¯•å¤±è´¥
ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡! Agent ç³»ç»Ÿå·²å‡†å¤‡å°±ç»ª!
```

---

## ğŸ› æ•…éšœæ’é™¤

### é—®é¢˜: "RAG å¼•æ“æœªåˆå§‹åŒ–"

**è§£å†³æ–¹æ¡ˆ**:
1. ä¸Šä¼  PDF æ–‡æ¡£: `POST /upload`
2. å¤„ç†æ–‡æ¡£: `POST /process/{document_id}`
3. ç¡®è®¤ç´¢å¼•å·²åˆ›å»º: `GET /agent/status`

### é—®é¢˜: "API Key æœªè®¾ç½®"

**è§£å†³æ–¹æ¡ˆ**:
æ£€æŸ¥ `.env` æ–‡ä»¶,ç¡®ä¿åŒ…å«:
```env
OPENAI_API_KEY=...
DEEPSEEK_API_KEY=...
```

### é—®é¢˜: Agent ç”Ÿæˆå¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ API Key æ˜¯å¦æœ‰æ•ˆ
2. æ£€æŸ¥ç½‘ç»œè¿æ¥
3. æŸ¥çœ‹æ—¥å¿—: `llamareport-backend.log`
4. ç¡®ä¿æ–‡æ¡£å·²æ­£ç¡®å¤„ç†

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### å½“å‰æ€§èƒ½

- å•ç« èŠ‚ç”Ÿæˆ: ~30-60ç§’
- å®Œæ•´æŠ¥å‘Šç”Ÿæˆ: ~2-5åˆ†é’Ÿ
- æ¨¡æ¿æ¸²æŸ“: <1ç§’

### ä¼˜åŒ–å»ºè®®

1. **å¹¶è¡Œç”Ÿæˆ**: ä½¿ç”¨ `asyncio.gather` å¹¶è¡Œç”Ÿæˆç« èŠ‚
2. **ç¼“å­˜**: ç¼“å­˜å¸¸ç”¨çš„æŸ¥è¯¢ç»“æœ
3. **æµå¼è¾“å‡º**: æ”¯æŒ SSE æµå¼è¿”å›
4. **æ‰¹å¤„ç†**: æ‰¹é‡å¤„ç†å¤šä¸ªæŠ¥å‘Šè¯·æ±‚

---

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®!è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤:

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚

---

## ğŸ‘¥ ä½œè€…

- **AI Agent** - *åˆå§‹å¼€å‘* - Claude 4.0 Sonnet

---

## ğŸ™ è‡´è°¢

- [LlamaIndex](https://www.llamaindex.ai/) - Agent æ¡†æ¶
- [DeepSeek](https://www.deepseek.com/) - LLM æœåŠ¡
- [OpenAI](https://openai.com/) - Embedding æœåŠ¡
- [FastAPI](https://fastapi.tiangolo.com/) - Web æ¡†æ¶
- [Jinja2](https://jinja.palletsprojects.com/) - æ¨¡æ¿å¼•æ“

---

**ç‰ˆæœ¬**: 1.0.0  
**æœ€åæ›´æ–°**: 2025-10-01  
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª

