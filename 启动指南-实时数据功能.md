# 🚀 实时数据功能启动指南

## ⚡ 5分钟快速启动

---

## 第一步：安装依赖（2分钟）

```bash
# 在项目根目录
pip install -r requirements.txt
pip install -r llamareport-backend/requirements.txt
```

新增依赖会自动安装：
- tushare
- requests  
- beautifulsoup4
- lxml

---

## 第二步：配置环境（可选，1分钟）

编辑 `.env` 文件:

```env
# 必需（已有）
OPENAI_API_KEY=your-key
DEEPSEEK_API_KEY=your-key

# 可选（推荐）⭐
TUSHARE_API_TOKEN=your-token
ENABLE_REALTIME_DATA=true
```

**重要**: 
- ✅ 不配置 `TUSHARE_API_TOKEN` 也能用
- ✅ 系统会自动使用免费的新浪财经

---

## 第三步：启动服务（2分钟）

### 🅰️ 使用 Streamlit 前端（推荐）

**终端1 - Backend**:
```bash
cd llamareport-backend
python main.py

# 等待看到:
✅ LlamaReport Backend 启动完成
✅ 加载了 5 个实时数据工具
```

**终端2 - Streamlit**:
```bash
# 返回项目根目录
streamlit run app.py

# 等待看到:
You can now view your Streamlit app in your browser.
Local URL: http://localhost:8501
```

**访问**: http://localhost:8501

---

### 🅱️ 使用 Backend HTML 前端（简单）

**终端1 - Backend**:
```bash
cd llamareport-backend
python main.py
```

**访问**: http://localhost:8000

---

## 第四步：开始使用（1分钟）

### Streamlit 前端

```
1. 浏览器访问: http://localhost:8501
2. 侧边栏点击: 📈 实时数据 [NEW]
3. 看到6个标签页
4. 选择功能开始查询！
```

### Backend HTML 前端

```
1. 浏览器访问: http://localhost:8000
2. 找到橙色的"实时数据查询"区域
3. 输入股票代码
4. 点击功能按钮查询！
```

---

## 🎯 快速测试

### 测试1: 查询实时股价

**Streamlit**:
```
1. 点击 "📈 实时数据"
2. 在 "💰 实时股价" 标签
3. 点击快捷按钮: 🍷 贵州茅台
4. 点击: 🔍 查询股价
5. 查看结果！
```

**Backend HTML**:
```
1. 在"实时数据查询"区域
2. 点击快捷选择: 贵州茅台
3. 点击: 💰 实时股价
4. 查看结果！
```

---

### 测试2: Agent 综合分析

**Streamlit**:
```
1. 点击 "📈 实时数据"
2. 切换到 "🤖 综合分析" 标签
3. 输入: "贵州茅台值得投资吗？"
4. 点击: 🤖 开始分析
5. 等待10-30秒
6. 查看完整分析报告！
```

**Backend HTML**:
```
1. 在"智能问答"区域
2. 输入: "贵州茅台值得投资吗？"
3. 点击: 🤖 Agent 智能分析
4. 等待10-30秒
5. 查看完整分析报告！
```

---

## 🔍 验证checklist

启动后检查以下项目：

### Backend 服务

- [ ] 终端显示: ✅ LlamaReport Backend 启动完成
- [ ] 终端显示: ✅ 加载了 5 个实时数据工具
- [ ] 访问 http://localhost:8000/docs 看到 API 文档
- [ ] 看到 `/realtime` 标签和7个端点

### Streamlit 前端

- [ ] 浏览器自动打开 http://localhost:8501
- [ ] 侧边栏看到 "📈 实时数据 [NEW]"
- [ ] 点击后看到6个标签页
- [ ] Backend 状态显示 "✅ 在线"

### 功能测试

- [ ] 实时股价查询成功
- [ ] 市场概览查询成功
- [ ] Agent 综合分析成功
- [ ] 数据源状态正常显示

---

## ⚠️ 常见问题

### Q: Backend 启动失败

**检查**:
1. 是否在 `llamareport-backend/` 目录？
2. 是否安装了依赖？
3. 是否配置了必需的 API Keys？

**解决**:
```bash
cd llamareport-backend
pip install -r requirements.txt
python quick_start_realtime.py  # 运行诊断
```

---

### Q: Streamlit 前端显示"无法连接到 Backend"

**原因**: Backend 未启动

**解决**:
1. 检查 Backend 终端是否在运行
2. 访问 http://localhost:8000/health 验证
3. 如未启动，运行 `python main.py`

---

### Q: 实时数据查询失败

**检查**:
1. Backend 是否正常运行？
2. 股票代码格式是否正确？（600519.SH）
3. 网络是否正常？

**诊断**:
```bash
# 检查 Backend API
curl http://localhost:8000/realtime/health

# 检查数据源状态
curl http://localhost:8000/realtime/statistics
```

---

## 💡 使用技巧

### 技巧1: 快捷股票选择

**Streamlit**:
- 点击快捷按钮（贵州茅台、五粮液等）
- 自动填充股票代码

**Backend HTML**:
- 点击快捷选择链接
- 自动填充股票代码

### 技巧2: Agent 综合分析

**最佳问题格式**:
```
好的问题:
✅ "贵州茅台值得投资吗？"
✅ "对比分析贵州茅台和五粮液"
✅ "中国平安的投资风险如何？"

Agent 会自动:
1. 查询实时股价
2. 分析历史数据
3. 获取最新新闻
4. 检查预警
5. 给出建议
```

### 技巧3: 查看工具调用

**Streamlit**:
- Agent 分析完成后
- 点击 "🔧 使用的工具" 展开
- 看到 Agent 调用了哪些工具

**示例**:
```
🔧 使用的工具 (4个)
1. get_realtime_stock_price
2. annual_report_query  
3. get_latest_financial_news
4. check_stock_alerts
```

---

## 📚 完整文档列表

### 快速入门（优先阅读）

1. **启动指南-实时数据功能.md** ⭐ 本文件
2. **开始使用实时数据功能.md** - 3步快速入门
3. **STREAMLIT前端实时数据使用指南.md** - Streamlit 专用指南

### 功能说明

4. **实时数据功能说明.md** - 功能概述
5. **REALTIME_DATA_GUIDE.md** - 完整使用指南
6. **REALTIME_FEATURE_EXAMPLES.md** - 详细示例

### 技术文档

7. **REALTIME_IMPLEMENTATION_REPORT.md** - 实施报告
8. **CODE_CHANGES_SUMMARY.md** - 代码变更
9. **FRONTEND_REALTIME_UPDATE.md** - 前端修改说明

### 对比分析

10. **完整功能对比.md** - 升级前后对比
11. **实时数据功能完整交付报告.md** - 总交付报告

---

## 🎊 开始探索

### 推荐操作流程

```
第1步: 启动两个服务
   终端1: cd llamareport-backend && python main.py
   终端2: streamlit run app.py

第2步: 访问 Streamlit
   http://localhost:8501

第3步: 点击"实时数据"
   侧边栏 → 📈 实时数据

第4步: 快速测试
   点击"贵州茅台" → 点击"查询股价" → 看到实时数据！

第5步: 深度探索
   试试各个标签页的功能
   试试 Agent 综合分析
```

---

## 📊 功能总览

### 您现在拥有

**数据分析能力**:
- ✅ 历史年报深度分析
- ✅ 实时数据快速查询 ⭐
- ✅ 综合投资决策支持 ⭐

**前端选择**:
- ✅ Streamlit 精美前端（推荐）
- ✅ Backend HTML 简单前端
- ✅ REST API 调用

**数据来源**:
- ✅ 年报文档（ChromaDB）
- ✅ 实时行情（新浪/Tushare）⭐
- ✅ 财经新闻（多源聚合）⭐
- ✅ 公司公告（Tushare/巨潮）⭐

**智能能力**:
- ✅ 14个 Agent 工具
- ✅ 自动工具选择
- ✅ 多维度综合分析

---

## 🎯 下一步建议

1. ✅ **立即启动测试**（按上述流程）
2. ✅ **体验各项功能**（股价、新闻、预警等）
3. ✅ **试用 Agent 分析**（综合投资分析）
4. ⏳ **收集用户反馈**（优化改进）
5. ⏳ **生产环境部署**（如满意）

---

**所有功能已完成，开始享用吧！** 🎉

---

## 📞 需要帮助？

### 诊断工具

```bash
# 运行自动诊断
cd llamareport-backend
python quick_start_realtime.py
```

### 查看日志

```bash
# Backend 日志
tail -f llamareport-backend/llamareport-backend.log

# 搜索实时数据相关
grep "realtime" llamareport-backend/llamareport-backend.log
```

### 查看文档

13份完整文档已准备好，按需查阅！

---

**祝您使用愉快！** 🎊

